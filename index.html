<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Snake The Game</title>
</head>

<body>
	<canvas id="canvas" width="400" height="400"></canvas>
	
	
<script>
// Set Global Variables
	var canvas, ctx;

	// Snake
	var defaultTailSize = 3;
	var tailSize = defaultTailSize;
	var snakeTrail = [];
	var snakeX = (snakeY = 10);

	// Game World
	var gridSize = tileSize = 20;
	var nextX = (nextY = 0);
	var score = 0;

	// Apple
	var appleX = (appleY = 15);

	// Game State
	var gameState = false;
	

	// Set first function get canvas and ctx on window load
	window.onload = function() {
		canvas = document.getElementById("canvas");
		ctx = canvas.getContext("2d");
		
		// Add Event Listener		
		document.addEventListener("keydown", keyDownEvent);
		var x = 8;

		// // Set Start Screen
		// setInterval(startScreen, 1000 / x);

		// // Set Game Loop
		// if (gameState == true) {
		// 	setInterval(draw, 1000 / x);
		// }
		startScreen();
		
		var gameInterval;

		function startGame() {
			gameInterval = setInterval(draw, 1000 / x);
		}
	
		// Input Functions
		function keyDownEvent(e) {
			if (e.keyCode == 32) {
				if (!gameState)
					gameState = true;
					startGame();
			} else {
				switch (e.keyCode) {
					case 37:
						nextX = -1;
						nextY = 0;
						break;
					case 38:
						console.log
						nextX = 0;
						nextY = -1;
						break;
					case 39:
						nextX = 1;
						nextY = 0;
						break;
					case 40:
						nextX = 0;
						nextY = 1;
						break;
				}
			}
		}

	};

	
	// Start Screen Function
	function startScreen() {
		ctx.fillStyle = 'white';
		ctx.fillRect(0, 0, canvas.width, canvas.height);
		ctx.font = "16px Arial";
		ctx.fillStyle = "#000000";
		ctx.fillText("Press Space to Start", 8, 20);
	}
	



	// Draw Function
	function draw() {


		if (!gameState) {
			startScreen();
			return;
		}
		// move snake to next position
		snakeX += nextX;
		snakeY += nextY;
		
		// Handle Snake Collision with Wall
		if (snakeX < 0) {
			snakeX = gridSize -1;
		}
		if (snakeX > gridSize -1) {
			snakeX = 0;
		}
		if (snakeY < 0) {
			snakeY = gridSize -1;
		}
		if (snakeY > gridSize -1) {
			snakeY = 0;
		}
		
		// Handle Snake Collision with Apple
		if (snakeX == appleX && snakeY == appleY) {
			tailSize++;
			score++;
			appleX = Math.floor(Math.random() * gridSize);
			appleY = Math.floor(Math.random() * gridSize);
		}

		// Setting Background Color
		ctx.fillStyle = 'black';
		ctx.fillRect(0, 0, canvas.width, canvas.height);

		// Score System
		ctx.font = "16px Arial";
		ctx.fillStyle = "#FFFFFF";
		ctx.fillText("Score: " + score, 8, 20);

		
		// Setting Snakes Color
		ctx.fillStyle = 'green';
		for (var i = 0; i < snakeTrail.length; i++) {
			ctx.fillRect(
				snakeTrail[i].x * tileSize,
				snakeTrail[i].y * tileSize,
				tileSize,
				tileSize
		);
		
		// Snake Interacts with own Tail?
		if (snakeTrail[i].x == snakeX && snakeTrail[i].y == snakeY) {
			tailSize = defaultTailSize;
		}
		}
		
		// Set Apple Color
		ctx.fillStyle = 'red';
		ctx.fillRect(appleX * tileSize, appleY * tileSize, tileSize, tileSize);
		
		// Set Snake Trail
		snakeTrail.push({ x: snakeX, y: snakeY });
		
		while (snakeTrail.length > tailSize) {
			snakeTrail.shift();
		}
	}
	
// End of Functions
</script>
</body>
</html>
